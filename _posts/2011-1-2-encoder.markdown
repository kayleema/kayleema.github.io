---
layout: post
title:  "DIY Quadrature Encoder"
summary:  "A quadrature encoder I hacked together for a personal project"
---


Here is a circuit diagram for a quadrature encoder I made for a recent project using two phototransistors.


{% include /image.html  url="http://keeganmann.files.wordpress.com/2011/01/encoderout.png?w=300"  description="Encoder Schematic"  href="http://keeganmann.files.wordpress.com/2011/01/encoderout.png" %}


Schmitt triggers filter the output and adjustments can be made with the three potentiometers.  One is used for adjusting the LED current and the others are for adjusting tuning the sensitivity of each phototransistor. Here is the finished board.


{% include /image.html  url="http://keeganmann.files.wordpress.com/2011/01/img_4302.jpg?w=300"  description="Encoder Circuit Board"  href="http://keeganmann.files.wordpress.com/2011/01/img_4302.jpg" %}

I notches out of an index card because it ended up working better than a black and white pattern on the card. Here is a diagram I made planning the circuit board.


{% include /image.html  url="http://keeganmann.files.wordpress.com/2011/01/encoderpcbscale.jpg?w=300"  description="Encoder Circuit Board Plan"  href="http://keeganmann.files.wordpress.com/2011/01/encoderpcbscale.jpg" %}

##How it Works

A quadrature encoder works by measuring two square wave signals which are ninety degrees out of phase and advance as the wheel turns. Â These two signals are generated by the two photointerruptors.

It is called a quadrature encoder because the two signals are always in one of four states.


{% include /image.html  url="http://keeganmann.files.wordpress.com/2010/08/encoderwaveform.png?w=300"  description="Quadrature encoder waveform oscilloscope trace with the different states labeled."  href="http://keeganmann.files.wordpress.com/2011/01/encoderwaveform.png" %}

By detecting the transitions between states, we can detect clockwise and counterclockwise steps.


{% include /image.html  url="http://keeganmann.files.wordpress.com/2011/01/quadraturelogic.png?w=300"  description="A diagram of all the possible state changes on the two lines (A and B).  &quot;0&quot; denotes no change, &quot;+&quot; denotes a clockwise step, &quot;-&quot; denotes a counterclockwise step, and &quot;E&quot; denotes an error."  href="http://keeganmann.files.wordpress.com/2011/01/quadraturelogic.png" %}

